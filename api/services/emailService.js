const nodemailer = require('nodemailer');
require('dotenv').config();
// Logo image for emails (base64 PNG data URL)
const LOGO_PNG_DATA_URL = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABpAAAAaQCAYAAABsIx3BAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAdnJLH8AAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB+kKDAkIMWsv9k4AACAASURBVHja7N0/a11lAIDxJ01j8U+1Di46WKxdS0GFuikOLbo4ODh26uIn6CC4OTjo7KCgH8BJaVcXC1Wo4mSt6KAgCjb1HzU0cbinJo0porZJ7jm/HxzuuSHDve89yZtznvveFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPz/9uCABAAAAEDQ/9ftCFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIChAM6MbuXZvgvIAAAAAElFTkSuQmCC';


// Create transporter
const transporter = nodemailer.createTransport({
  host: process.env.SMTP_HOST,
  port: process.env.SMTP_PORT,
  secure: process.env.SMTP_SECURE === 'true',
  auth: {
    user: process.env.SMTP_USER,
    pass: process.env.SMTP_PASS,
  },
});

// Verify transporter configuration (optional, for development)
const verifyTransporter = async () => {
  try {
    await transporter.verify();
    console.log('✓ El servicio de correo está listo para enviar mensajes');
  } catch (error) {
    console.warn('⚠ Servicio de correo no configurado - no se enviarán correos');
    console.warn('  Configure los ajustes SMTP en .env para habilitar notificaciones por correo');
  }
};

// SVG Logo - embedded for email compatibility
const LOGO_SVG = `
<svg width="200" height="55" viewBox="0 0 494.243 135.467" xmlns="http://www.w3.org/2000/svg">
  <path fill="#000000" d="m 25.4,0 h 84.66667 Q 120.5744,0 128.02054,7.4461313 135.46667,14.892262 135.46667,25.4 v 84.66667 q 0,10.50773 -7.44613,17.95387 -7.44614,7.44613 -17.95387,7.44613 H 25.4 q -10.50773,0 -17.9538599,-7.44613 Q 0,120.5744 0,110.06667 V 25.4 Q 0,14.892262 7.4461401,7.4461313 14.89227,0 25.4,0 Z m 53.59703,29.255357 q 0,-3.628571 -1.28512,-5.140476 Q 76.42679,22.602976 73.025,22.602976 H 56.46965 q -1.43631,3.628572 -5.78304,8.353274 -4.34672,4.724702 -7.74851,5.934226 -1.36071,0.453572 -2.53244,2.267857 -1.17173,1.814286 -1.17173,3.401786 v 7.408333 q 0,2.267858 1.6631,3.930953 1.66309,1.663095 4.00655,1.663095 1.5119,0 2.91041,-0.377976 1.39851,-0.377976 2.30566,-0.79375 0.90714,-0.415774 2.04107,-1.43631 1.13393,-1.020535 1.5497,-1.436309 0.41577,-0.415774 1.51191,-1.776488 1.09613,-1.360715 1.24732,-1.511905 V 90.336308 H 44.67679 q -2.26786,0 -3.93095,1.6253 -1.6631,1.6253 -1.6631,3.96875 v 11.263692 q 0,2.34345 1.6631,4.00655 1.66309,1.66309 3.93095,1.66309 h 46.037498 q 2.34345,0 4.006551,-1.66309 1.66309,-1.6631 1.66309,-4.00655 V 95.930358 q 0,-2.34345 -1.66309,-3.96875 -1.663101,-1.6253 -4.006551,-1.6253 H 78.99703 Z" />
  <path fill="#000000" d="m 229.65866,0 q 10.50773,0 17.95387,7.4083337 7.44613,7.4083333 7.44613,17.9160713 v 84.666665 q 0,10.50773 -7.44613,17.95387 -7.44614,7.44613 -17.95387,7.44613 h -84.66667 q -10.50773,0 -17.95386,-7.44613 -7.44614,-7.44614 -7.44614,-17.95387 V 25.324405 q 0,-10.507738 7.44614,-17.9160713 Q 134.48426,0 144.99199,0 Z m -81.03809,69.925595 q -1.13393,1.28512 -1.85209,2.834822 -0.71815,1.549702 -1.13393,2.608036 -0.41577,1.058333 -0.60476,3.099404 -0.18899,2.041072 -0.22678,2.834822 -0.0378,0.79375 0,3.439583 0.0378,2.645833 0.0378,3.326191 0,2.343448 1.5497,4.006548 1.5497,1.66309 3.74196,1.66309 h 43.54286 v 13.455949 q 0,2.26786 1.70089,3.93096 1.7009,1.66309 3.96875,1.66309 h 9.6006 q 2.34345,0 4.00655,-1.6253 1.66309,-1.62529 1.66309,-3.96875 V 93.738091 h 9.97857 q 2.19226,0 3.74196,-1.66309 1.5497,-1.6631 1.5497,-4.006548 v -7.9375 q 0,-2.343453 -1.5497,-4.006548 -1.5497,-1.663095 -3.74196,-1.663095 h -9.97857 V 28.121429 q 0,-2.267857 -1.6631,-3.930953 -1.66309,-1.663095 -4.00654,-1.663095 h -9.6006 q -11.26369,0 -12.92679,1.889881 z m 19.35238,4.535715 q 8.01309,-9.298215 25.70238,-30.313691 V 74.46131 Z" />
  <path fill="#000000" d="m 264.58398,0 h 84.66667 q 10.50773,0 17.95387,7.4461313 7.44613,7.4461307 7.44613,17.9538687 v 84.66667 q 0,10.50773 -7.44613,17.95387 -7.44614,7.44613 -17.95387,7.44613 h -84.66667 q -10.50773,0 -17.95386,-7.44613 -7.44614,-7.44614 -7.44614,-17.95387 V 25.4 q 0,-10.507738 7.44614,-17.9538687 Q 254.07625,0 264.58398,0 Z m 42.33334,112.86369 q 11.33928,0 20.90208,-6.04762 9.5628,-6.04762 15.15684,-16.441962 5.59405,-10.394346 5.59405,-22.640775 0,-12.246428 -5.59405,-22.640773 -5.59404,-10.394346 -15.15684,-16.441965 -9.5628,-6.047619 -20.90208,-6.047619 -11.33929,0 -20.90209,6.047619 -9.56279,6.047619 -15.15684,16.441965 -5.59405,10.394345 -5.59405,22.640773 0,12.246429 5.59405,22.640775 5.59405,10.394342 15.15684,16.441962 9.5628,6.04762 20.90209,6.04762 z m -5.82084,-20.486312 q 3.02381,0.75595 5.66965,0.75595 9.60059,0 16.36637,-7.332733 6.76577,-7.332738 6.76577,-18.067262 0,-8.08869 -4.23333,-14.741071 z m 11.64167,-49.288092 q -3.02381,-0.755953 -5.66964,-0.755953 -9.67619,0.0756 -16.40417,7.370536 -6.72797,7.294941 -6.72797,18.029464 0,8.088691 4.23333,14.741072 z" />
  <path fill="#000000" d="m 384.17597,0 h 84.66667 q 10.50773,0 17.95387,7.4461313 7.44613,7.4461307 7.44613,17.9538687 v 84.66667 q 0,10.50773 -7.44613,17.95387 -7.44614,7.44613 -17.95387,7.44613 h -84.66667 q -10.50773,0 -17.95386,-7.44613 -7.44614,-7.44614 -7.44614,-17.95387 V 25.4 q 0,-10.507738 7.44614,-17.9538687 Q 373.66824,0 384.17597,0 Z m 25.62679,41.728571 q 15.72381,0 18.67202,0.226786 11.94405,0.831548 16.93334,5.972024 5.74524,5.896429 5.74524,19.503571 0,4.913691 -0.71816,8.769048 -0.71815,3.855357 -2.07887,6.576786 -1.36071,2.721428 -3.32619,4.686904 -1.96548,1.965477 -4.42232,3.137198 -2.45685,1.17173 -5.36726,1.88989 -2.91042,0.71815 -6.23661,0.94494 -3.32619,0.22678 -6.99256,0.34017 -3.66637,0.1134 -7.59732,-0.0378 h -4.61131 z M 391.13074,28.272619 v 78.921431 q 0,2.34345 1.66309,4.00655 1.6631,1.66309 3.93095,1.66309 h 30.69167 q 21.16667,0 31.97678,-11.33929 10.81012,-11.339281 10.81012,-34.017852 0,-44.903572 -43.16488,-44.903572 h -30.31369 q -2.26785,0 -3.93095,1.663095 -1.66309,1.663096 -1.66309,4.006548 z" />
</svg>
`.trim();

// Generate buyer email HTML
const generateBuyerEmailHTML = (orderDetails) => {
  const { orderId, items, totalPrice } = orderDetails;

  const itemsHTML = items.map(item => `
    <tr>
      <td style="padding: 12px 0; border-bottom: 1px solid #e5e7eb;">
        <div style="font-weight: 600; color: #111827; margin-bottom: 4px;">${item.name}</div>
        ${item.variant_key ? `<div style="font-size: 14px; color: #6b7280; margin-bottom: 4px;">${item.variant_key}</div>` : ''}
        ${item.type ? `<div style="font-size: 14px; color: #6b7280; margin-bottom: 4px;">Soporte: ${item.type}</div>` : ''}
        <div style="font-size: 14px; color: #6b7280;">Precio: €${item.price_at_purchase.toFixed(2)}</div>
        ${item.shipping_method_name ? `
          <div style="font-size: 14px; color: #6b7280; margin-top: 4px;">
            Envío: ${item.shipping_method_name}${item.shipping_method_type === 'pickup' ? ' (Recogida)' : ''} - €${(item.shipping_cost || 0).toFixed(2)}
          </div>
        ` : ''}
      </td>
    </tr>
  `).join('');

  return `
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Confirmación de pedido</title>
</head>
<body style="margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: #f9fafb;">
  <table width="100%" cellpadding="0" cellspacing="0" style="background-color: #f9fafb; padding: 40px 20px;">
    <tr>
      <td align="center">
        <table width="600" cellpadding="0" cellspacing="0" style="background-color: #ffffff; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);">
          <!-- Logo Header -->
          <tr>
            <td style="padding: 40px 40px 30px; text-align: center; border-bottom: 2px solid #000000;">
              ${LOGO_SVG}
            </td>
          </tr>

          <!-- Content -->
          <tr>
            <td style="padding: 40px;">
              <h1 style="margin: 0 0 20px; font-size: 24px; font-weight: 600; color: #111827;">Confirmación de pedido</h1>

              <p style="margin: 0 0 20px; font-size: 16px; line-height: 1.5; color: #374151;">
                Hemos recibido tu pedido y estamos procesándolo.
              </p>

              <!-- Order Details -->
              <div style="background-color: #f9fafb; border-radius: 8px; padding: 20px; margin: 30px 0;">
                <table width="100%" cellpadding="0" cellspacing="0">
                  <tr>
                    <td style="padding-bottom: 8px;">
                      <strong style="color: #111827;">Número de pedido:</strong> #${orderId}
                    </td>
                  </tr>
                  <tr>
                    <td style="padding-bottom: 8px;">
                      <strong style="color: #111827;">Fecha:</strong> ${new Date().toLocaleDateString('es-ES', { day: 'numeric', month: 'long', year: 'numeric' })}
                    </td>
                  </tr>
                </table>
              </div>

              <!-- Items -->
              <h2 style="margin: 30px 0 15px; font-size: 18px; font-weight: 600; color: #111827;">Artículos</h2>
              <table width="100%" cellpadding="0" cellspacing="0">
                ${itemsHTML}
                <tr>
                  <td style="padding: 20px 0 0; text-align: right;">
                    <div style="font-size: 18px; font-weight: 700; color: #111827;">
                      Total: €${totalPrice.toFixed(2)}
                    </div>
                  </td>
                </tr>
              </table>

              ${items.some(item => item.shipping_method_type === 'delivery') ? `
                <p style="margin: 30px 0 0; font-size: 14px; line-height: 1.5; color: #6b7280;">
                  Te enviaremos información de seguimiento una vez que tus artículos sean enviados.
                </p>
              ` : ''}
              ${items.some(item => item.shipping_method_type === 'pickup') ? `
                <p style="margin: 30px 0 0; font-size: 14px; line-height: 1.5; color: #6b7280;">
                  <strong>Recogida en tienda:</strong> Te contactaremos pronto para coordinar la recogida de tus artículos.
                </p>
              ` : ''}
            </td>
          </tr>

          <!-- Footer -->
          <tr>
            <td style="padding: 30px 40px; background-color: #f9fafb; border-top: 1px solid #e5e7eb;">
              <p style="margin: 0; font-size: 14px; color: #6b7280;">
                Este es un correo automático. Por favor no responder.
              </p>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</body>
</html>
  `.trim();
};

// Generate seller email HTML
const generateSellerEmailHTML = (orderDetails, sellerItems) => {
  const { orderId, buyerEmail } = orderDetails;

  const itemsHTML = sellerItems.map(item => `
    <tr>
      <td style="padding: 12px 0; border-bottom: 1px solid #e5e7eb;">
        <div style="font-weight: 600; color: #111827; margin-bottom: 4px;">${item.name}</div>
        ${item.variant_key ? `<div style="font-size: 14px; color: #6b7280; margin-bottom: 4px;">${item.variant_key}</div>` : ''}
        ${item.type ? `<div style="font-size: 14px; color: #6b7280; margin-bottom: 4px;">Soporte: ${item.type}</div>` : ''}
        <div style="font-size: 14px; color: #6b7280;">Precio: €${item.price_at_purchase.toFixed(2)}</div>
        ${item.shipping_method_name ? `
          <div style="font-size: 14px; color: #6b7280; margin-top: 4px;">
            Envío: ${item.shipping_method_name}${item.shipping_method_type === 'pickup' ? ' (Recogida)' : ''} - €${(item.shipping_cost || 0).toFixed(2)}
          </div>
        ` : ''}
      </td>
    </tr>
  `).join('');

  const sellerTotal = sellerItems.reduce((sum, item) => sum + item.price_at_purchase + (item.shipping_cost || 0), 0);

  return `
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nuevo pedido recibido</title>
</head>
<body style="margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: #f9fafb;">
  <table width="100%" cellpadding="0" cellspacing="0" style="background-color: #f9fafb; padding: 40px 20px;">
    <tr>
      <td align="center">
        <table width="600" cellpadding="0" cellspacing="0" style="background-color: #ffffff; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);">
          <!-- Logo Header -->
          <tr>
            <td style="padding: 40px 40px 30px; text-align: center; border-bottom: 2px solid #000000;">
              ${LOGO_SVG}
            </td>
          </tr>

          <!-- Content -->
          <tr>
            <td style="padding: 40px;">
              <h1 style="margin: 0 0 20px; font-size: 24px; font-weight: 600; color: #111827;">Nuevo pedido recibido</h1>

              <p style="margin: 0 0 20px; font-size: 16px; line-height: 1.5; color: #374151;">
                Has recibido un nuevo pedido con tus productos.
              </p>

              <!-- Order Details -->
              <div style="background-color: #f9fafb; border-radius: 8px; padding: 20px; margin: 30px 0;">
                <table width="100%" cellpadding="0" cellspacing="0">
                  <tr>
                    <td style="padding-bottom: 8px;">
                      <strong style="color: #111827;">Número de pedido:</strong> #${orderId}
                    </td>
                  </tr>
                  <tr>
                    <td style="padding-bottom: 8px;">
                      <strong style="color: #111827;">Fecha:</strong> ${new Date().toLocaleDateString('es-ES', { day: 'numeric', month: 'long', year: 'numeric' })}
                    </td>
                  </tr>
                  <tr>
                    <td style="padding-bottom: 8px;">
                      <strong style="color: #111827;">Comprador:</strong> ${buyerEmail || 'Comprador invitado'}
                    </td>
                  </tr>
                </table>
              </div>

              <!-- Items -->
              <h2 style="margin: 30px 0 15px; font-size: 18px; font-weight: 600; color: #111827;">Tus productos vendidos</h2>
              <table width="100%" cellpadding="0" cellspacing="0">
                ${itemsHTML}
                <tr>
                  <td style="padding: 20px 0 0; text-align: right;">
                    <div style="font-size: 18px; font-weight: 700; color: #111827;">
                      Total: €${sellerTotal.toFixed(2)}
                    </div>
                  </td>
                </tr>
              </table>

              <p style="margin: 30px 0 0; font-size: 14px; line-height: 1.5; color: #6b7280;">
                Por favor, prepara los productos para su envío o recogida según el método seleccionado.
              </p>
            </td>
          </tr>

          <!-- Footer -->
          <tr>
            <td style="padding: 30px 40px; background-color: #f9fafb; border-top: 1px solid #e5e7eb;">
              <p style="margin: 0; font-size: 14px; color: #6b7280;">
                Este es un correo automático. Por favor no responder.
              </p>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</body>
</html>
  `.trim();
};

// Generate admin email HTML
const generateAdminEmailHTML = (orderDetails) => {
  const { orderId, items, totalPrice, buyerEmail, buyerContact, contactType, sellers } = orderDetails;

  const itemsHTML = items.map(item => `
    <tr>
      <td style="padding: 12px 0; border-bottom: 1px solid #e5e7eb;">
        <div style="font-weight: 600; color: #111827; margin-bottom: 4px;">${item.name}</div>
        ${item.variant_key ? `<div style="font-size: 14px; color: #6b7280; margin-bottom: 4px;">${item.variant_key}</div>` : ''}
        ${item.type ? `<div style="font-size: 14px; color: #6b7280; margin-bottom: 4px;">Soporte: ${item.type}</div>` : ''}
        <div style="font-size: 14px; color: #6b7280;">Precio: €${item.price_at_purchase.toFixed(2)}</div>
        ${item.shipping_method_name ? `
          <div style="font-size: 14px; color: #6b7280; margin-top: 4px;">
            Envío: ${item.shipping_method_name}${item.shipping_method_type === 'pickup' ? ' (Recogida)' : ''} - €${(item.shipping_cost || 0).toFixed(2)}
          </div>
        ` : ''}
      </td>
    </tr>
  `).join('');

  const sellersHTML = sellers.map(seller => `
    <tr>
      <td style="padding: 8px 0;">
        <div style="font-weight: 600; color: #111827;">${seller.name || 'N/A'}</div>
        <div style="font-size: 14px; color: #6b7280;">${seller.email}</div>
      </td>
    </tr>
  `).join('');

  return `
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nuevo pedido - Admin</title>
</head>

<body style="margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: #f9fafb;">
<div class="header">
      <img src="${LOGO_PNG_DATA_URL}" alt="Kuadrat Gallery Logo" style="max-width: 180px; height: auto; margin-bottom: 10px;">
      <h1 style="color: #4F46E5; margin: 0;">140d</h1>
    </div>
  <table width="100%" cellpadding="0" cellspacing="0" style="background-color: #f9fafb; padding: 40px 20px;">
    <tr>
      <td align="center">
        <table width="600" cellpadding="0" cellspacing="0" style="background-color: #ffffff; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);">
          <!-- Content -->
          <tr>
            <td style="padding: 40px;">
              <h1 style="margin: 0 0 20px; font-size: 24px; font-weight: 600; color: #111827;">Nuevo pedido registrado</h1>

              <!-- Order Details -->
              <div style="background-color: #f9fafb; border-radius: 8px; padding: 20px; margin: 30px 0;">
                <table width="100%" cellpadding="0" cellspacing="0">
                  <tr>
                    <td style="padding-bottom: 8px;">
                      <strong style="color: #111827;">Número de pedido:</strong> #${orderId}
                    </td>
                  </tr>
                  <tr>
                    <td style="padding-bottom: 8px;">
                      <strong style="color: #111827;">Fecha:</strong> ${new Date().toLocaleDateString('es-ES', { day: 'numeric', month: 'long', year: 'numeric' })}
                    </td>
                  </tr>
                  <tr>
                    <td style="padding-bottom: 8px;">
                      <strong style="color: #111827;">Comprador:</strong> ${buyerEmail || 'Comprador invitado'}
                    </td>
                  </tr>
                  <tr>
                    <td style="padding-bottom: 8px;">
                      <strong style="color: #111827;">Contacto:</strong> ${buyerContact} (${contactType === 'email' ? 'Email' : 'WhatsApp'})
                    </td>
                  </tr>
                </table>
              </div>

              <!-- Sellers -->
              <h2 style="margin: 30px 0 15px; font-size: 18px; font-weight: 600; color: #111827;">Vendedores involucrados</h2>
              <table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom: 30px;">
                ${sellersHTML}
              </table>

              <!-- Items -->
              <h2 style="margin: 30px 0 15px; font-size: 18px; font-weight: 600; color: #111827;">Artículos del pedido</h2>
              <table width="100%" cellpadding="0" cellspacing="0">
                ${itemsHTML}
                <tr>
                  <td style="padding: 20px 0 0; text-align: right;">
                    <div style="font-size: 18px; font-weight: 700; color: #111827;">
                      Total: €${totalPrice.toFixed(2)}
                    </div>
                  </td>
                </tr>
              </table>
            </td>
          </tr>

          <!-- Footer -->
          <tr>
            <td style="padding: 30px 40px; background-color: #f9fafb; border-top: 1px solid #e5e7eb;">
              <p style="margin: 0; font-size: 14px; color: #6b7280;">
                Panel de administración - Notificación automática
              </p>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</body>
</html>
  `.trim();
};

// Send purchase confirmation email to buyer, sellers, and admin
const sendPurchaseConfirmation = async (orderDetails) => {
  const { orderId, items, totalPrice, buyerEmail, sellers } = orderDetails;
  const results = [];

  // 1. Send email to buyer
  if (buyerEmail) {
    const buyerMailOptions = {
      from: process.env.EMAIL_FROM,
      to: buyerEmail,
      subject: `Confirmación de pedido #${orderId}`,
      html: generateBuyerEmailHTML(orderDetails),
    };

    try {
      const info = await transporter.sendMail(buyerMailOptions);
      console.log(`✓ Email de confirmación enviado al comprador (${buyerEmail}):`, info.messageId);
      results.push({ recipient: 'buyer', success: true, messageId: info.messageId });
    } catch (error) {
      console.error(`✗ Error enviando email al comprador (${buyerEmail}):`, error);
      results.push({ recipient: 'buyer', success: false, error: error.message });
    }
  }

  // 2. Send emails to each seller with their items
  for (const seller of sellers) {
    // Filter items that belong to this seller
    const sellerItems = items.filter(item => item.seller_id === seller.id);

    const sellerMailOptions = {
      from: process.env.EMAIL_FROM,
      to: seller.email,
      subject: `Nuevo pedido #${orderId} - Productos vendidos`,
      html: generateSellerEmailHTML(orderDetails, sellerItems),
    };

    try {
      const info = await transporter.sendMail(sellerMailOptions);
      console.log(`✓ Email enviado al vendedor (${seller.email}):`, info.messageId);
      results.push({ recipient: `seller:${seller.email}`, success: true, messageId: info.messageId });
    } catch (error) {
      console.error(`✗ Error enviando email al vendedor (${seller.email}):`, error);
      results.push({ recipient: `seller:${seller.email}`, success: false, error: error.message });
    }
  }

  // 3. Send email to admin
  const adminEmail = process.env.REGISTRATION_EMAIL;
  if (adminEmail) {
    const adminMailOptions = {
      from: process.env.EMAIL_FROM,
      to: adminEmail,
      subject: `[ADMIN] Nuevo pedido #${orderId} - Total: €${totalPrice.toFixed(2)}`,
      html: generateAdminEmailHTML(orderDetails),
    };

    try {
      const info = await transporter.sendMail(adminMailOptions);
      console.log(`✓ Email enviado al administrador (${adminEmail}):`, info.messageId);
      results.push({ recipient: 'admin', success: true, messageId: info.messageId });
    } catch (error) {
      console.error(`✗ Error enviando email al administrador (${adminEmail}):`, error);
      results.push({ recipient: 'admin', success: false, error: error.message });
    }
  }

  return {
    success: results.every(r => r.success),
    results,
  };
};

// Send registration request notification email
const sendRegistrationRequest = async (userEmail) => {
  const mailOptions = {
    from: process.env.EMAIL_FROM,
    to: process.env.REGISTRATION_EMAIL,
    subject: 'Nueva solicitud de registro',
    text: `
Hola,

Se ha recibido una nueva solicitud de registro de artista en Kuadrat Gallery.

Correo electrónico del solicitante: ${userEmail}

Por favor, revisa esta solicitud y contacta al usuario para completar el proceso de registro.

Saludos,
Sistema Kuadrat Gallery
    `,
    html: `
<!DOCTYPE html>
<html>
<head>
  <style>
    body { font-family: 'Inter', Arial, sans-serif; line-height: 1.6; color: #333; }
    .container { max-width: 600px; margin: 0 auto; padding: 20px; }
    .header { border-bottom: 2px solid #000000; padding-bottom: 20px; margin-bottom: 20px; }
    .content { background-color: #f9fafb; padding: 20px; border-radius: 8px; margin: 20px 0; }
    .email-highlight { font-size: 1.1em; font-weight: bold; color: #000000; }
    .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #e5e7eb; font-size: 0.9em; color: #6b7280; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <img src="${LOGO_PNG_DATA_URL}" alt="Kuadrat Gallery Logo" style="max-width: 180px; height: auto; margin-bottom: 10px;">
      <h1 style="color: #000000; margin: 0;">Kuadrat Gallery</h1>
      <p style="margin: 5px 0 0 0;">Nueva Solicitud de Registro</p>
    </div>

    <h2>Solicitud de Registro de Artista</h2>
    <p>Se ha recibido una nueva solicitud de registro en Kuadrat Gallery.</p>

    <div class="content">
      <p><strong>Correo electrónico del solicitante:</strong></p>
      <p class="email-highlight">${userEmail}</p>
    </div>

    <p>Por favor, revisa esta solicitud y contacta al usuario para completar el proceso de registro.</p>

    <div class="footer">
      <p>Saludos,<br>Sistema Kuadrat Gallery</p>
      <p style="font-size: 0.8em;">Este es un correo automático. Por favor no responder.</p>
    </div>
  </div>
</body>
</html>
    `,
  };

  try {
    const info = await transporter.sendMail(mailOptions);
    console.log('Correo de solicitud de registro enviado:', info.messageId);
    return { success: true, messageId: info.messageId };
  } catch (error) {
    console.error('Error al enviar el correo de solicitud de registro:', error);
    return { success: false, error: error.message };
  }
};

module.exports = {
  verifyTransporter,
  sendPurchaseConfirmation,
  sendRegistrationRequest,
};
